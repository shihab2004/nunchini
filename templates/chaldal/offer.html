<style>
    .stopSelect{
        user-select: none;
    }
</style>

<section class="bodyTable">
    <div>
        <div class="" id="your-offers">
            <div class="filterTile">
                <div class="filterHeader">
                    <div class="filterImg">
                        <svg fill="#214354" viewBox="0 0 100 100">
                            <path
                                d="M86,19L56,49v24l-12,8V49L14,19H86 M86,15H14c-1.6,0-3.1,1-3.7,2.5c-0.6,1.5-0.3,3.2,0.9,4.4L40,50.7V81 c0,1.5,0.8,2.8,2.1,3.5c0.6,0.3,1.2,0.5,1.9,0.5c0.8,0,1.5-0.2,2.2-0.7l12-8c1.1-0.7,1.8-2,1.8-3.3V50.7l28.8-28.8 c1.1-1.1,1.5-2.9,0.9-4.4C89.1,16,87.6,15,86,15L86,15z M57.7,42.7l18-18c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-18,18 c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3S57.5,42.9,57.7,42.7z">
                            </path>
                        </svg>
                    </div>
                    <div class="filterHeaderName">Filter By Category</div>
                    <div class="filterCollapse">
                        <div>
                            <svg style="fill: #214354;stroke: #214354;display: inline-block;vertical-align: middle;" width="18px" height="18px" version="1.1" viewBox="0 0 100 100" x="0px" y="0px">
                                <g transform="translate(0,-952.36218)">
                                    <path style="text-indent: 0px;text-transform: none;direction: ltr;block-progression: tb;baseline-shift: baseline;color: #000000;enable-background: accumulate;" d="" fill-opacity="1" stroke="none"></path>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mainTile">

              
            </div>
            <h1 class="stopSelect">Special Offers</h1>
            <ul class="offer-container">

             
            </ul>
        </div>
    </div>
</section>

<script>
{% if is_nedd_obj %}

const offer_seT_event =(json_obj)=>{
        $('.offer-container').empty();
        json_obj.forEach(prod =>{
           const filtered_product_obj = new offerProductObj(prod);
           filtered_product_obj.set_html();
        })

            ajx_updataion = true;
            current_bag_item.forEach((item_pd)=>{
                for(var cnt=0;cnt<item_pd.quantity;cnt++){
                     $(`.product[product-id="${item_pd.product_id}"] .imageWrapper`).click();
                     $(`#bag_bat_${item_pd.product_id}`).remove();
                } 
            })
            ajx_updataion = false;

         
        

    }



class offerProductObj{
    constructor(json){
        this.id = json.pk
        this.name = json.Name;
        this.img = json.image_link;
        this.price = json.Price
        this.discordPrice = json.discord_price;
        this.amount = json.Amount;
        this.slug = json.slug;
        this.actionDiv = $('.offer-container');
        this.offerImg = json.offer_img;
        this.willgetdt_url = `/product/${this.slug}/`;
    }

    get_html(){
        const html = `
                        <li class="offer-item">
                            <h2>${this.name}</h2>
                            <img src="${this.offerImg}" alt="${this.name}" class="offer-image" />
                            <div class="product" product-id="${this.id}">
                                <div class="imageWrapper">
                                    <div class="imageWrapperWrapper">
                                        <img src="${this.img}" size="400" style="background-color: transparent" />
                                    </div>
                                    <div class="name">${this.name}</div>
                                    <div class="subText">${this.amount}</div>
                                    <div class="discountedPriceSection">
                                        <div class="discountedPrice">
                                            <span>৳ </span><span>${this.discordPrice}</span>
                                        </div>
                                        <div class="price"><span>৳ </span><span>${this.price}</span></div>
                                    </div>
                                    <div class="overlay text">
                                        <p class="addText">Add to Shopping Bag</p>
                                        <span><a href="${this.willgetdt_url}"class="btnShowDetails"><span>Details</span><span> &gt;</span></a>
                                            <a href="${this.willgetdt_url}" class="btnShowDetailsIcon">
                                                <svg
                                                    width="24px" height="24px" style="fill: #e1e1e1;stroke: #e1e1e1;display: inline-block;vertical-align: middle;" version="1.1" viewBox="0 0 100 100">
                                                    <path
                                                        d="m50 5c-24.898 0-45 20.102-45 45s20.102 45 45 45 45-20.102 45-45-20.102-45-45-45zm7.1016 70c0 2.1992-1.8984 4.1016-4.1016 4.1016h-6.1992c-2.1992 0-4.1016-1.8984-4.1016-4.1016v-26.199c0-2.3008 1.8984-4.1016 4.1016-4.1016h6.1992c2.1992 0 4.1016 1.8984 4.1016 4.1016zm-7.2031-37.102c-4.6016 0-8.3984-3.8008-8.3984-8.5 0-4.6992 3.8008-8.5 8.3984-8.5 4.6992 0 8.5 3.8008 8.5 8.5 0 4.7031-3.7969 8.5-8.5 8.5z">
                                                    </path>
                                                </svg>
                                            </a>
                                        </span>
                                    </div>
                                </div>
                                <span class="linkStore">
                                    <a href="${this.willgetdt_url}"
                                        class="btnShowDetails"><span>Details</span><span> &gt;</span></a>
                                        <a href="${this.willgetdt_url}" class="btnShowDetailsIcon">
                                            <svg width="24px" height="24px" style="fill: #e1e1e1;stroke: #e1e1e1;display: inline-block;vertical-align: middle;" version="1.1" viewBox="0 0 100 100">
                                            <path
                                                d="m50 5c-24.898 0-45 20.102-45 45s20.102 45 45 45 45-20.102 45-45-20.102-45-45-45zm7.1016 70c0 2.1992-1.8984 4.1016-4.1016 4.1016h-6.1992c-2.1992 0-4.1016-1.8984-4.1016-4.1016v-26.199c0-2.3008 1.8984-4.1016 4.1016-4.1016h6.1992c2.1992 0 4.1016 1.8984 4.1016 4.1016zm-7.2031-37.102c-4.6016 0-8.3984-3.8008-8.3984-8.5 0-4.6992 3.8008-8.5 8.3984-8.5 4.6992 0 8.5 3.8008 8.5 8.5 0 4.7031-3.7969 8.5-8.5 8.5z">
                                            </path>
                                            </svg>
                                        </a>
                                </span>
                                <section id='bag_bat_${this.id}' class="addButtonWrapper asd border-radius-small">
                                    <span class="express" id="svgIcon">
                                        <svg width="22px" height="25px" style="display: inline-block; vertical-align: middle" version="1.1" x="0px" y="0px" viewBox="-9 11 100 100">
                                            <path class="st0"
                                                d="M59.4,32.6c0.2,0.2-0.2,0.3-0.2,0.3s-1.2,0.3-1.5,0.8c-0.3,0.3-0.8,1.5-0.8,1.5c0.7-0.2,1.5-0.3,2.3-0.7 c0.2,0,0.3,0.2,0.5,0.3c0.2,0-2,0.8-2.5,1.2c-0.3,0.3-2,1.7-2.5,1.7S53,37.9,53,37.9c0.2,0.3,0.3,0.7,0.7,1.2c0,0-1.2,0.7-1.2,0.8 c-0.2,0.2-1,1.2-1,1.2s3,0.3,4-1.3c-1,1.7-3.3,3.3-8.2,3.3c-5,0-9-2-11.7-3c-2.8-1.2-6.5-2.5-9.5-2.5c-2.8,0-6.2,0.8-8.4,2.9 c-3.9-1.5-9.2-0.7-11.7,1.7c-2.3,2.3-4.7,5.2-5,7.2c-0.5,2.2-1.7,7.4-3.3,9.7c-2.3,3.8-5,4.8-5.9,6.5c-0.8,1.7-0.8,5.2-0.7,5.2 c0.3,0.2,1.5,0,2.2-0.3c1.3-0.5,5-4.3,6.4-6.2c1.3-1.8,5.9-9.9,6.5-12.7c0.7-2.8,1.3-5.7,3.3-7.2c2.2-1.5,4.8-0.8,4.8-0.7 c0,0-2.5,2-2.7,7.5c-0.2,5.5,3.2,4.9,1.5,8.4c-1.7,3-6.7,1-8.4,2.8c-1.3,1.5,0,6.9,0,7.9c0,1-0.5,5.7-0.8,6.9c-0.2,1,0,1.7-0.2,2.3 c-0.2,0.5,1,0.7,1,0.7s-1,1.3-1.5,1c-0.5-0.2-0.8-0.2-1.2,0c-0.3,0-1,0.3-1.7,0l-2.7,5.7c0.3,0.2,0.8,0.3,1.3,0.2 c0.7-0.2,4-1.7,4.4-2c0.5-0.2,3.3-1.8,3.8-2.8c0.3-1,1-4.2,1-5.2c0.2-1,0.3-4.2,0.3-5c0-0.8-0.2-2.3,0-3c0.3-0.5,0.8-1.2,1.5-1.5 c0.8-0.2,1.8-0.2,2-0.2c0.3,0,3.2,0.3,3.7,0.3c0.7,0,3.3-0.5,4-0.8c0.8-0.2,1.3,0,1.5,0.3c0.3,0.3-0.3,0.8-0.3,1 c-0.2,0.2-1.5,1.8-1.8,2.5c-0.3,0.8-1.5,2.3-1.2,3c0.3,0.7,0.3,0.8,1.3,1.3c1,0.3,4.9,2.3,7,4.3c2.3,2.2,4.5,4.8,4.9,6.2 c0.5,1.5,1.3,1.7,1.8,1.7c0.5,0.2,1.5,0.3,1.5,1c0,0.7-0.2,1.5-0.2,1.5l6.2,2.3c0,0,0-2.2-0.2-3c-0.2-1-1.2-2-2-3 c-0.8-1.2-9.5-9.7-10.4-10.4c-0.8-0.5-1.5-1.2-1.7-2.5c-0.2-1.3,1.5-2.3,2.5-3.5c0.7-0.8,2.5-4.7,2.8-5.2c0.3-0.5,1.5-1.8,2.2-1.8 c0.8,0,2.7,1.2,5,2c1,0.3,8.2,2.2,9.2,2.5c1,0.2,3.2,0,3.8,0.7c0.7,0.5,0,1.8-0.2,2.7c-0.2,1-2,4.7-2,4.7s0.3,1.3,0.3,2.4 c0,1.2-0.5,5.3-1,6.7c-0.3,1.5-2.7,5.4-3.2,6c-0.3,0.5-0.8,0.8-0.8,1.7c0,0.8,1.5,1,2,1.7c0.7,0.5,0.2,1.5,0,2.5l6.7,2.8 c0-0.5,0.3-1.3,0-1.7c-0.2-0.5-1-1.5-1.5-2.2c-0.3-0.5-1.5-2.3-1.8-2.7c-0.3-0.5-0.3-1.5,0-2.3c0.2-0.8,2.3-6.5,2.5-7.2 c0.3-0.8,3.5-7.5,3.8-8.4c0.3-1,3-5.9,3.3-6.7c0.3-1,2.5-1.8,3.2-1.8c0.8,0,5,1.5,5.7,1.8c0.5,0.2,4.4,1.8,5,2.2 c0.8,0.3,0.3,1-0.2,1.2c-0.5,0.3-6.7,4.5-7.2,4.7c-0.5,0.2-1,0.7-1.3,0.7c-0.5,0-1.2,0.5-1.2,0.7c0,0.3-0.2,1-1,1c-0.7,0-2-1-2.8-2 c-1.2,0.7-2,1.2-2.5,2.2c-0.8,0.8-1.2,1.5-1.7,2.7c0.3,0.3,1,0.5,1.5,0.5h5.4c0.5,0,1.2-0.2,1.7-0.3c0.5-0.3,13.7-9,13.7-9 s2.2-1.7,2.2-3.2c0-1.2-1-1.5-1.3-2c-0.5-0.3-3.5-2.3-4-2.7c-0.7-0.5-3-1.8-3.7-2.2c-0.5-0.3-2.4-1-2.4-1c0.5-1.5,0.8-2.7,1-3 c0.2-0.3,0.2-3.4,0.3-3.9c0-0.5,0.8-2.7,1.2-3c0.3-0.3,1.2-3,1.3-3.5c0.2-0.3,1.5-4.2,2.2-4.2c0.7-0.2,1.3,0.5,2,0.5 c0.7,0.2,3.2-0.2,4.5,0c1.2,0.2,2.7,1.7,3,1.8c0.5,0.2,1.7,0.7,2,0.7c0.2,0,1.8-1.2,1.8-1.5c0-0.3-1.2-1-1.3-1 c-0.2-0.2-1.3-0.8-1.3-0.8c0,0.2,0.5-0.3,1.3-0.3c0.7,0,1.3,0.7,1.5,0.8c0.3,0.2,1.2,0.7,1.3,0.3c0.2-0.2,0.8-1,0.8-1.5 c0-0.7-0.7-1.5-1-1.8c-0.3-0.3-4.2-4-4.5-4.2c-0.5-0.2-2.5-2-2.5-2.5c-0.2-0.3-1.2-1.2-1.3-1.3c-0.2-0.2-5.2-3.7-5.9-4.2 c-0.7-0.5-1.3-1.3-1.3-2.2c0-0.8-0.3-3-0.3-3s-1.2-0.2-1.7,0.3c-0.5,0.3-1.7,3-2.3,3c-1.8-0.3-4.2,0.2-4.2,0.5 c0.2,0.5,1.8,0.2,1.8,0.2c0,0.2-0.7,1-1.2,1c-0.3,0-1.3,0.3-1.5,0.5c-0.3,0-1,0.5-1,0.5c0.5,0,1,0,1.7,0.2c0,0-1,0.7-1.5,0.7 c-0.5,0-2.2,0.5-2.7,0.7c-0.3,0.3-1.7,1.3-1.7,1.3h-1.5l0.2,0.3h0.8L59.4,32.6L59.4,32.6z">
                                            </path>
                                        </svg>
                                    </span>
                                    <p class="buyText">Add to bag</p>
                                </section>
                            </div>
                        </li>
             `;
        return html;
    }
    set_html(){
        this.actionDiv.append(this.get_html());
    }
   
}

$(`[mat='{% url "product:offer" %}?matRout=True&obj=True']`).attr("mat","{% url 'product:offer' %}?matRout=True")


const offer_filter_arrow_down = 'm 49.999995,1048.3622 c 25.34582,0 46.00001,-20.6541 46.00001,-46 0,-25.34572 -20.65415,-46.00002 -46.00001,-46.00002 -25.3459,0 -46,20.6543 -46,46.00002 0,25.3459 20.6541,46 46,46 z m 0,-10 c -19.9415,0 -36,-16.0585 -36,-36 0,-19.94132 16.0585,-36.00002 36,-36.00002 19.94137,0 36.00001,16.0587 36.00001,36.00002 0,19.9415 -16.0586,36 -36.00001,36 z m 0,-14.1875 3.40626,-3.125 26,-24.00002 -6.8125,-7.3437 -22.59376,20.84372 -22.5937,-20.84372 -6.8125,7.3437 26,24.00002 3.4062,3.125 z';
const offer_filter_arrow_up = 'm 50,956.36217 c -25.34581,0 -46,20.65409 -46,46.00003 0,25.3457 20.65416,46 46,46 25.34592,0 46,-20.6543 46,-46 0,-25.34592 -20.65411,-46.00003 -46,-46.00003 z m 0,10 c 19.94151,0 36,16.05849 36,36.00003 0,19.9413 -16.05852,36 -36,36 -19.94136,0 -36,-16.0587 -36,-36 0,-19.94152 16.05861,-36.00003 36,-36.00003 z m 0,14.1875 -3.40625,3.125 -26,24.00003 6.8125,7.3437 L 50,994.17467 l 22.59375,20.84373 6.8125,-7.3437 -26,-24.00003 L 50,980.54967 z';
{% endif %}



    var offer_product_json;
    $.ajax({
        type:"GET",
        url:"{% url 'product:offer' %}?json=True",
        success:(data)=>{
            data.data.menu.forEach(menu =>{
                $('.mainTile').append(`
                <a class="stopSelect">
                    <div class="categoryBox">
                        <div class="categoryName">
                            <span>${menu.name}</span><span> </span><span><span>(</span><span>${menu.count}</span><span>)</span></span>
                        </div>
                        <div class="categoryImg">
                            <img
                                src="${menu.img}" />
                        </div>
                    </div>
                </a>
                `)
            });
            offer_product_json= data.data.product;
            data.data.product.forEach(pd =>{
                 const product = new offerProductObj(pd);
                 console.log(product);
                 product.set_html();
                 
            });

            //set event 


           
            ajx_updataion = true;
            current_bag_item.forEach((item_pd)=>{
                for(var cnt=0;cnt<item_pd.quantity;cnt++){
                     $(`.product[product-id="${item_pd.product_id}"] .imageWrapper`).click();
                     $(`#bag_bat_${item_pd.product_id}`).remove();
                } 
            })
            ajx_updataion = false;


            

                // other code 


                $('.mainTile  .categoryBox').click((e)=>{
                    const menu_name = e.currentTarget.querySelector('.categoryName span').textContent;
                    $('.filterHeaderName').text(`Filter By Category > ${menu_name}`);
                    const filtered_product = offer_product_json.filter(product => product.menu_name == menu_name);
                       
            
                    offer_seT_event(filtered_product);

                    if(!$('.clearFilter').length){
                        $('.filterHeader').append(`
                        <div class="clearFilter"><svg style="fill:#214354;stroke:#214354;display:inline-block;vertical-align:middle;" width="18px" height="18px" viewBox="0 0 100 100"><g><path d="M50,0.495c-24.812,0-45,20.188-45,45.001c0,24.812,20.188,44.999,45,44.999s45-20.187,45-44.999 C95,20.683,74.812,0.495,50,0.495z M50,80.37c-19.262,0-34.875-15.613-34.875-34.874C15.125,26.234,30.738,10.62,50,10.62 s34.875,15.614,34.875,34.876C84.875,64.757,69.262,80.37,50,80.37z"></path><path d="M65.734,29.76c-1.978-1.977-5.183-1.977-7.16,0.001L50,38.336l-8.576-8.575c-1.977-1.978-5.182-1.978-7.159-0.001 c-1.978,1.978-1.978,5.183,0,7.159l8.575,8.576l-8.575,8.576c-1.978,1.977-1.978,5.182,0,7.159 c0.989,0.988,2.284,1.482,3.58,1.482s2.591-0.494,3.579-1.483L50,52.654l8.574,8.575c0.989,0.989,2.285,1.483,3.58,1.483 s2.592-0.494,3.58-1.482c1.977-1.978,1.977-5.183,0-7.159l-8.576-8.576l8.576-8.576C67.711,34.942,67.711,31.737,65.734,29.76z"></path></g></svg><span> </span><span>Clear Filter</span></div>
                        `)
                        $('.clearFilter').click(()=>{
                            $('.filterHeaderName').text(`Filter By Category`);
                            $('.clearFilter').remove()
                            offer_seT_event(offer_product_json);
                        })
                   }
                });
        },
        error:()=>alert("NETWORK CONNECTION ERROR!😥")
    })


  



$('.filterCollapse path').attr('d',offer_filter_arrow_up);


$('.filterCollapse').click(()=>{
 
    if($('.filterCollapse').hasClass('offer_jojo')){
        $('.filterCollapse path').attr('d',offer_filter_arrow_up);
    }else{
        $('.filterCollapse path').attr('d',offer_filter_arrow_down);
    }
    $('.filterCollapse').toggleClass('offer_jojo');
    $('.mainTile a').toggle();
})

$('.hamBergerMenuIcon.change').click();
setTitle('Special Offer 😍')
</script>